<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- editorconfig-checker-disable-file</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes    #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DefaultSignatures      #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts       #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances      #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE GADTs                  #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase             #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings      #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes             #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell        #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications       #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances   #-}</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- | Support for generating PIR with global definitions with dependencies between them.</span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PlutusIR.Compiler.Definitions</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier">DefT</span></a></span><span>
</span><span id="line-16"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier">MonadDefs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#TermDefWithStrictness"><span class="hs-identifier">TermDefWithStrictness</span></a></span><span>
</span><span id="line-18"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#runDefT"><span class="hs-identifier">runDefT</span></a></span><span>
</span><span id="line-19"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#defineTerm"><span class="hs-identifier">defineTerm</span></a></span><span>
</span><span id="line-20"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#modifyTermDef"><span class="hs-identifier">modifyTermDef</span></a></span><span>
</span><span id="line-21"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#defineType"><span class="hs-identifier">defineType</span></a></span><span>
</span><span id="line-22"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#modifyTypeDef"><span class="hs-identifier">modifyTypeDef</span></a></span><span>
</span><span id="line-23"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#defineDatatype"><span class="hs-identifier">defineDatatype</span></a></span><span>
</span><span id="line-24"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#modifyDatatypeDef"><span class="hs-identifier">modifyDatatypeDef</span></a></span><span>
</span><span id="line-25"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#modifyDeps"><span class="hs-identifier">modifyDeps</span></a></span><span>
</span><span id="line-26"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#recordAlias"><span class="hs-identifier">recordAlias</span></a></span><span>
</span><span id="line-27"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#lookupTerm"><span class="hs-identifier">lookupTerm</span></a></span><span>
</span><span id="line-28"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#lookupOrDefineTerm"><span class="hs-identifier">lookupOrDefineTerm</span></a></span><span>
</span><span id="line-29"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#lookupType"><span class="hs-identifier">lookupType</span></a></span><span>
</span><span id="line-30"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#lookupOrDefineType"><span class="hs-identifier">lookupOrDefineType</span></a></span><span>
</span><span id="line-31"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#lookupConstructors"><span class="hs-identifier">lookupConstructors</span></a></span><span>
</span><span id="line-32"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#lookupDestructor"><span class="hs-identifier">lookupDestructor</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.html"><span class="hs-identifier">PlutusIR</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PIR</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.MkPir.html"><span class="hs-identifier">PlutusIR.MkPir</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.MkPlc.html#error"><span class="hs-identifier">error</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.MkPlc.html"><span class="hs-identifier">PlutusCore.MkPlc</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PLC</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Quote.html"><span class="hs-identifier">PlutusCore.Quote</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../lens/html/src"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../mtl/html/src"><span class="hs-identifier">Control.Monad.Except</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../mmorph/html/src"><span class="hs-identifier">Control.Monad.Morph</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MM</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../mtl/html/src"><span class="hs-identifier">Control.Monad.Reader</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../mtl/html/src"><span class="hs-identifier">Control.Monad.State</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../mtl/html/src"><span class="hs-identifier">Control.Monad.Writer</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../algebraic-graphs/html/src"><span class="hs-identifier">Algebra.Graph.AdjacencyMap</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AM</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../algebraic-graphs/html/src"><span class="hs-identifier">Algebra.Graph.AdjacencyMap.Algorithm</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AM</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../algebraic-graphs/html/src"><span class="hs-identifier">Algebra.Graph.NonEmpty.AdjacencyMap</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NAM</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../algebraic-graphs/html/src"><span class="hs-identifier">Algebra.Graph.ToGraph</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Graph</span></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">first</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">second</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">{- Note [Annotations on Bindings]

When constructing Bindings (including TermBind, TypeBind and DatatypeBind) from definitions
in `runDefT`, we use the annotation on the VarDecl and TyVarDecl as the annotation of the
Binding itself. The reason is that the simplifier looks at the annotation of a Binding as
one of the factors to determine whether to inline the Binding. When we define a term that
should be inlined, we put the corresponding annotation in the VarDecl or TyVarDecl (note
that there's no need to annotate the term itself), and that annotation needs to be copied
to the Binding when creating the Binding.
-}</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | A map from keys to pairs of bindings and their dependencies (as a list of keys).</span><span>
</span><span id="line-70"></span><span class="hs-keyword">type</span><span> </span><span id="DefMap"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefMap"><span class="hs-identifier hs-var">DefMap</span></a></span></span><span> </span><span id="local-6989586621681110784"><span class="annot"><a href="#local-6989586621681110784"><span class="hs-identifier hs-type">key</span></a></span></span><span> </span><span id="local-6989586621681110783"><span class="annot"><a href="#local-6989586621681110783"><span class="hs-identifier hs-type">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110784"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681110783"><span class="hs-identifier hs-type">def</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110784"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span id="local-6989586621681111408"><span id="local-6989586621681111409"><span id="local-6989586621681111410"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#mapDefs"><span class="hs-identifier hs-type">mapDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681111410"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681111409"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefMap"><span class="hs-identifier hs-type">DefMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111408"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111410"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefMap"><span class="hs-identifier hs-type">DefMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111408"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111409"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-73"></span><span id="mapDefs"><span class="annot"><span class="annottext">mapDefs :: forall a b key. (a -&gt; b) -&gt; DefMap key a -&gt; DefMap key b
</span><a href="PlutusIR.Compiler.Definitions.html#mapDefs"><span class="hs-identifier hs-var hs-var">mapDefs</span></a></span></span><span> </span><span id="local-6989586621681110779"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621681110779"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621681110779"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">type</span><span> </span><span id="TermDefWithStrictness"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#TermDefWithStrictness"><span class="hs-identifier hs-var">TermDefWithStrictness</span></a></span></span><span> </span><span id="local-6989586621681110777"><span class="annot"><a href="#local-6989586621681110777"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621681110776"><span class="annot"><a href="#local-6989586621681110776"><span class="hs-identifier hs-type">fun</span></a></span></span><span> </span><span id="local-6989586621681110775"><span class="annot"><a href="#local-6989586621681110775"><span class="hs-identifier hs-type">ann</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="PlutusCore.MkPlc.html#Def"><span class="hs-identifier hs-type">PLC.Def</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110777"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110775"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110777"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110776"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110775"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Strictness"><span class="hs-identifier hs-type">Strictness</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">data</span><span> </span><span id="DefState"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefState"><span class="hs-identifier hs-var">DefState</span></a></span></span><span> </span><span id="local-6989586621681111395"><span class="annot"><a href="#local-6989586621681111395"><span class="hs-identifier hs-type">key</span></a></span></span><span> </span><span id="local-6989586621681111394"><span class="annot"><a href="#local-6989586621681111394"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621681111393"><span class="annot"><a href="#local-6989586621681111393"><span class="hs-identifier hs-type">fun</span></a></span></span><span> </span><span id="local-6989586621681111392"><span class="annot"><a href="#local-6989586621681111392"><span class="hs-identifier hs-type">ann</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DefState"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefState"><span class="hs-identifier hs-var">DefState</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-79"></span><span>    </span><span id="_termDefs"><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
DefState key uni fun ann
-&gt; DefMap key (TermDefWithStrictness uni fun ann)
</span><a href="PlutusIR.Compiler.Definitions.html#_termDefs"><span class="hs-identifier hs-var hs-var">_termDefs</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefMap"><span class="hs-identifier hs-type">DefMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111395"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#TermDefWithStrictness"><span class="hs-identifier hs-type">TermDefWithStrictness</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111394"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111393"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111392"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>    </span><span id="_typeDefs"><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
DefState key uni fun ann -&gt; DefMap key (TypeDef TyName uni ann)
</span><a href="PlutusIR.Compiler.Definitions.html#_typeDefs"><span class="hs-identifier hs-var hs-var">_typeDefs</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefMap"><span class="hs-identifier hs-type">DefMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111395"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.MkPlc.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111394"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111392"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>    </span><span id="_datatypeDefs"><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
DefState key uni fun ann
-&gt; DefMap key (DatatypeDef TyName Name uni ann)
</span><a href="PlutusIR.Compiler.Definitions.html#_datatypeDefs"><span class="hs-identifier hs-var hs-var">_datatypeDefs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefMap"><span class="hs-identifier hs-type">DefMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111395"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.MkPir.html#DatatypeDef"><span class="hs-identifier hs-type">DatatypeDef</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111394"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111392"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>    </span><span id="_aliases"><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
DefState key uni fun ann -&gt; Set key
</span><a href="PlutusIR.Compiler.Definitions.html#_aliases"><span class="hs-identifier hs-var hs-var">_aliases</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111395"><span class="hs-identifier hs-type">key</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-84"></span><span id="typeDefs"><span id="termDefs"><span id="datatypeDefs"><span id="aliases"><span id="local-6989586621681111368"><span id="local-6989586621681111392"><span id="local-6989586621681111393"><span id="local-6989586621681111394"><span id="local-6989586621681111395"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">DefState</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">newtype</span><span> </span><span id="DefT"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-var">DefT</span></a></span></span><span> </span><span id="local-6989586621681111341"><span class="annot"><a href="#local-6989586621681111341"><span class="hs-identifier hs-type">key</span></a></span></span><span> </span><span id="local-6989586621681111340"><span class="annot"><a href="#local-6989586621681111340"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621681111339"><span class="annot"><a href="#local-6989586621681111339"><span class="hs-identifier hs-type">fun</span></a></span></span><span> </span><span id="local-6989586621681111338"><span class="annot"><a href="#local-6989586621681111338"><span class="hs-identifier hs-type">ann</span></a></span></span><span> </span><span id="local-6989586621681111337"><span class="annot"><a href="#local-6989586621681111337"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621681111336"><span class="annot"><a href="#local-6989586621681111336"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DefT"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-var">DefT</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unDefT"><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
DefT key uni fun ann m a -&gt; StateT (DefState key uni fun ann) m a
</span><a href="PlutusIR.Compiler.Definitions.html#unDefT"><span class="hs-identifier hs-var hs-var">unDefT</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefState"><span class="hs-identifier hs-type">DefState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111341"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111340"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111339"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111338"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621681111337"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111336"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681110724"><span id="local-6989586621681110729"><span class="annot"><span class="annottext">forall a b.
a -&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann m a
forall a b.
(a -&gt; b) -&gt; DefT key uni fun ann m a -&gt; DefT key uni fun ann m b
forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a b.
Functor m =&gt;
a -&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann m a
forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; DefT key uni fun ann m a -&gt; DefT key uni fun ann m b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: forall a b.
a -&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann m a
$c&lt;$ :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a b.
Functor m =&gt;
a -&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann m a
fmap :: forall a b.
(a -&gt; b) -&gt; DefT key uni fun ann m a -&gt; DefT key uni fun ann m b
$cfmap :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; DefT key uni fun ann m a -&gt; DefT key uni fun ann m b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681110697"><span id="local-6989586621681110701"><span id="local-6989586621681110705"><span id="local-6989586621681110709"><span id="local-6989586621681110714"><span class="annot"><span class="annottext">forall a. a -&gt; DefT key uni fun ann m a
forall a b.
DefT key uni fun ann m a
-&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann m a
forall a b.
DefT key uni fun ann m a
-&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann m b
forall a b.
DefT key uni fun ann m (a -&gt; b)
-&gt; DefT key uni fun ann m a -&gt; DefT key uni fun ann m b
forall a b c.
(a -&gt; b -&gt; c)
-&gt; DefT key uni fun ann m a
-&gt; DefT key uni fun ann m b
-&gt; DefT key uni fun ann m c
forall {key} {uni :: * -&gt; *} {fun} {ann} {m :: * -&gt; *}.
Monad m =&gt;
Functor (DefT key uni fun ann m)
forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
Monad m =&gt;
a -&gt; DefT key uni fun ann m a
forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a b.
Monad m =&gt;
DefT key uni fun ann m a
-&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann m a
forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a b.
Monad m =&gt;
DefT key uni fun ann m a
-&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann m b
forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a b.
Monad m =&gt;
DefT key uni fun ann m (a -&gt; b)
-&gt; DefT key uni fun ann m a -&gt; DefT key uni fun ann m b
forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; b -&gt; c)
-&gt; DefT key uni fun ann m a
-&gt; DefT key uni fun ann m b
-&gt; DefT key uni fun ann m c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: forall a b.
DefT key uni fun ann m a
-&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann m a
$c&lt;* :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a b.
Monad m =&gt;
DefT key uni fun ann m a
-&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann m a
*&gt; :: forall a b.
DefT key uni fun ann m a
-&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann m b
$c*&gt; :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a b.
Monad m =&gt;
DefT key uni fun ann m a
-&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann m b
liftA2 :: forall a b c.
(a -&gt; b -&gt; c)
-&gt; DefT key uni fun ann m a
-&gt; DefT key uni fun ann m b
-&gt; DefT key uni fun ann m c
$cliftA2 :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; b -&gt; c)
-&gt; DefT key uni fun ann m a
-&gt; DefT key uni fun ann m b
-&gt; DefT key uni fun ann m c
&lt;*&gt; :: forall a b.
DefT key uni fun ann m (a -&gt; b)
-&gt; DefT key uni fun ann m a -&gt; DefT key uni fun ann m b
$c&lt;*&gt; :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a b.
Monad m =&gt;
DefT key uni fun ann m (a -&gt; b)
-&gt; DefT key uni fun ann m a -&gt; DefT key uni fun ann m b
pure :: forall a. a -&gt; DefT key uni fun ann m a
$cpure :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
Monad m =&gt;
a -&gt; DefT key uni fun ann m a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></a></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681110676"><span id="local-6989586621681110680"><span id="local-6989586621681110685"><span class="annot"><span class="annottext">forall a. a -&gt; DefT key uni fun ann m a
forall a b.
DefT key uni fun ann m a
-&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann m b
forall a b.
DefT key uni fun ann m a
-&gt; (a -&gt; DefT key uni fun ann m b) -&gt; DefT key uni fun ann m b
forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
Monad m =&gt;
Applicative (DefT key uni fun ann m)
forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
Monad m =&gt;
a -&gt; DefT key uni fun ann m a
forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a b.
Monad m =&gt;
DefT key uni fun ann m a
-&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann m b
forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a b.
Monad m =&gt;
DefT key uni fun ann m a
-&gt; (a -&gt; DefT key uni fun ann m b) -&gt; DefT key uni fun ann m b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: forall a. a -&gt; DefT key uni fun ann m a
$creturn :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
Monad m =&gt;
a -&gt; DefT key uni fun ann m a
&gt;&gt; :: forall a b.
DefT key uni fun ann m a
-&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann m b
$c&gt;&gt; :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a b.
Monad m =&gt;
DefT key uni fun ann m a
-&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann m b
&gt;&gt;= :: forall a b.
DefT key uni fun ann m a
-&gt; (a -&gt; DefT key uni fun ann m b) -&gt; DefT key uni fun ann m b
$c&gt;&gt;= :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a b.
Monad m =&gt;
DefT key uni fun ann m a
-&gt; (a -&gt; DefT key uni fun ann m b) -&gt; DefT key uni fun ann m b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681110668"><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; DefT key uni fun ann m a
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; DefT key uni fun ann m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *).
(forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; t m a) -&gt; MonadTrans t
lift :: forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; DefT key uni fun ann m a
$clift :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; DefT key uni fun ann m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">MonadTrans</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681110658"><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) (n :: * -&gt; *) b.
Monad m =&gt;
(forall a. m a -&gt; n a)
-&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann n b
forall {k} (t :: (* -&gt; *) -&gt; k -&gt; *).
(forall (m :: * -&gt; *) (n :: * -&gt; *) (b :: k).
 Monad m =&gt;
 (forall a. m a -&gt; n a) -&gt; t m b -&gt; t n b)
-&gt; MFunctor t
forall (m :: * -&gt; *) (n :: * -&gt; *) b.
Monad m =&gt;
(forall a. m a -&gt; n a)
-&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann n b
hoist :: forall (m :: * -&gt; *) (n :: * -&gt; *) b.
Monad m =&gt;
(forall a. m a -&gt; n a)
-&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann n b
$choist :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) (n :: * -&gt; *) b.
Monad m =&gt;
(forall a. m a -&gt; n a)
-&gt; DefT key uni fun ann m b -&gt; DefT key uni fun ann n b
</span><a href="../../../../mmorph/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">MM.MFunctor</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681110640"><span id="local-6989586621681110645"><span id="local-6989586621681111226"><span class="annot"><a href="../../../../mtl/html/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111226"><span class="hs-identifier hs-type">e</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681110620"><span id="local-6989586621681110624"><span id="local-6989586621681110629"><span id="local-6989586621681111209"><span class="annot"><a href="../../../../mtl/html/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111209"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681110609"><span class="annot"><span class="annottext">forall a. Quote a -&gt; DefT key uni fun ann m a
forall {key} {uni :: * -&gt; *} {fun} {ann} {m :: * -&gt; *}.
MonadQuote m =&gt;
Monad (DefT key uni fun ann m)
forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
MonadQuote m =&gt;
Quote a -&gt; DefT key uni fun ann m a
forall (m :: * -&gt; *).
Monad m -&gt; (forall a. Quote a -&gt; m a) -&gt; MonadQuote m
liftQuote :: forall a. Quote a -&gt; DefT key uni fun ann m a
$cliftQuote :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
MonadQuote m =&gt;
Quote a -&gt; DefT key uni fun ann m a
</span><a href="PlutusCore.Quote.html#C%3AMonadQuote"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadQuote</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681110581"><span id="local-6989586621681110585"><span id="local-6989586621681110589"><span id="local-6989586621681110594"><span id="local-6989586621681111178"><span class="annot"><a href="../../../../mtl/html/src"><span class="hs-identifier hs-type">MonadWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111178"><span class="hs-identifier hs-type">w</span></a></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- Need to write this by hand, deriving wants to derive the one for DefState</span><span>
</span><span id="line-90"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681111162"><span id="local-6989586621681111163"><span id="local-6989586621681111164"><span id="local-6989586621681111165"><span id="local-6989586621681111166"><span id="local-6989586621681111167"><span class="annot"><a href="../../../../mtl/html/src"><span class="hs-identifier hs-type">MonadState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111167"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111166"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../mtl/html/src"><span class="hs-identifier hs-type">MonadState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111167"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-type">DefT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111165"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111164"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111163"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111162"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111166"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>    </span><span id="local-6989586621681110561"><span class="annot"><span class="annottext">get :: DefT key uni fun ann m s
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span id="local-6989586621681110555"><span class="annot"><span class="annottext">put :: s -&gt; DefT key uni fun ann m ()
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">put</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">put</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span id="local-6989586621681110549"><span class="annot"><span class="annottext">state :: forall a. (s -&gt; (a, s)) -&gt; DefT key uni fun ann m a
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span id="local-6989586621681111153"><span id="local-6989586621681111154"><span id="local-6989586621681111155"><span id="local-6989586621681111156"><span id="local-6989586621681111157"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#runDefT"><span class="hs-identifier hs-type">runDefT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111157"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111156"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681111155"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-type">DefT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111156"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111154"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111153"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111155"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111157"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111154"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111153"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111155"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681111157"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111154"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111153"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111155"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-96"></span><span id="runDefT"><span class="annot"><span class="annottext">runDefT :: forall (m :: * -&gt; *) key ann (uni :: * -&gt; *) fun.
(Monad m, Ord key) =&gt;
ann
-&gt; DefT key uni fun ann m (Term TyName Name uni fun ann)
-&gt; m (Term TyName Name uni fun ann)
</span><a href="PlutusIR.Compiler.Definitions.html#runDefT"><span class="hs-identifier hs-var hs-var">runDefT</span></a></span></span><span> </span><span id="local-6989586621681110534"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110534"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681110533"><span class="annot"><span class="annottext">DefT key uni fun ann m (Term TyName Name uni fun ann)
</span><a href="#local-6989586621681110533"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681110532"><span class="annot"><span class="annottext">Term TyName Name uni fun ann
</span><a href="#local-6989586621681110532"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681110531"><span class="annot"><span class="annottext">DefState key uni fun ann
</span><a href="#local-6989586621681110531"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">runStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
DefT key uni fun ann m a -&gt; StateT (DefState key uni fun ann) m a
</span><a href="PlutusIR.Compiler.Definitions.html#unDefT"><span class="hs-identifier hs-var">unDefT</span></a></span><span> </span><span class="annot"><span class="annottext">DefT key uni fun ann m (Term TyName Name uni fun ann)
</span><a href="#local-6989586621681110533"><span class="hs-identifier hs-var">act</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
DefMap key (TermDefWithStrictness uni fun ann)
-&gt; DefMap key (TypeDef TyName uni ann)
-&gt; DefMap key (DatatypeDef TyName Name uni ann)
-&gt; Set key
-&gt; DefState key uni fun ann
</span><a href="PlutusIR.Compiler.Definitions.html#DefState"><span class="hs-identifier hs-var">DefState</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall key ann tyname name (uni :: * -&gt; *) fun.
Ord key =&gt;
ann
-&gt; DefMap key (Binding tyname name uni fun ann)
-&gt; Term tyname name uni fun ann
-&gt; Term tyname name uni fun ann
</span><a href="PlutusIR.Compiler.Definitions.html#wrapWithDefs"><span class="hs-identifier hs-var">wrapWithDefs</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110534"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} {uni :: * -&gt; *} {fun} {a}.
Ord k =&gt;
DefState k uni fun a
-&gt; Map k (Binding TyName Name uni fun a, Set k)
</span><a href="#local-6989586621681110528"><span class="hs-identifier hs-var">bindingDefs</span></a></span><span> </span><span class="annot"><span class="annottext">DefState key uni fun ann
</span><a href="#local-6989586621681110531"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun ann
</span><a href="#local-6989586621681110532"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-99"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>            </span><span id="local-6989586621681110528"><span class="annot"><span class="annottext">bindingDefs :: DefState k uni fun a
-&gt; Map k (Binding TyName Name uni fun a, Set k)
</span><a href="#local-6989586621681110528"><span class="hs-identifier hs-var hs-var">bindingDefs</span></a></span></span><span> </span><span id="local-6989586621681110524"><span class="annot"><span class="annottext">DefState k uni fun a
</span><a href="#local-6989586621681110524"><span class="hs-identifier hs-var">defs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>                </span><span class="hs-keyword">let</span><span>
</span><span id="line-102"></span><span>                    </span><span class="hs-comment">-- See Note [Annotations on Bindings]</span><span>
</span><span id="line-103"></span><span>                    </span><span id="local-6989586621681110523"><span class="annot"><span class="annottext">terms :: Map k (Binding TyName Name uni fun a, Set k)
</span><a href="#local-6989586621681110523"><span class="hs-identifier hs-var hs-var">terms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b key. (a -&gt; b) -&gt; DefMap key a -&gt; DefMap key b
</span><a href="PlutusIR.Compiler.Definitions.html#mapDefs"><span class="hs-identifier hs-var">mapDefs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681110522"><span class="annot"><span class="annottext">Def
  (VarDecl TyName Name uni a)
  (Term TyName Name uni fun a, Strictness)
</span><a href="#local-6989586621681110522"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Strictness
-&gt; VarDecl tyname name uni a
-&gt; Term tyname name uni fun a
-&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-var">TermBind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) ann.
VarDecl tyname name uni ann -&gt; ann
</span><a href="PlutusCore.Core.Type.html#_varDeclAnn"><span class="hs-identifier hs-var">_varDeclAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall var val. Def var val -&gt; var
</span><a href="PlutusCore.MkPlc.html#defVar"><span class="hs-identifier hs-var">defVar</span></a></span><span> </span><span class="annot"><span class="annottext">Def
  (VarDecl TyName Name uni a)
  (Term TyName Name uni fun a, Strictness)
</span><a href="#local-6989586621681110522"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall var val. Def var val -&gt; val
</span><a href="PlutusCore.MkPlc.html#defVal"><span class="hs-identifier hs-var">PLC.defVal</span></a></span><span> </span><span class="annot"><span class="annottext">Def
  (VarDecl TyName Name uni a)
  (Term TyName Name uni fun a, Strictness)
</span><a href="#local-6989586621681110522"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall var val. Def var val -&gt; var
</span><a href="PlutusCore.MkPlc.html#defVar"><span class="hs-identifier hs-var">PLC.defVar</span></a></span><span> </span><span class="annot"><span class="annottext">Def
  (VarDecl TyName Name uni a)
  (Term TyName Name uni fun a, Strictness)
</span><a href="#local-6989586621681110522"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall var val. Def var val -&gt; val
</span><a href="PlutusCore.MkPlc.html#defVal"><span class="hs-identifier hs-var">PLC.defVal</span></a></span><span> </span><span class="annot"><span class="annottext">Def
  (VarDecl TyName Name uni a)
  (Term TyName Name uni fun a, Strictness)
</span><a href="#local-6989586621681110522"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
DefState key uni fun ann
-&gt; DefMap key (TermDefWithStrictness uni fun ann)
</span><a href="PlutusIR.Compiler.Definitions.html#_termDefs"><span class="hs-identifier hs-var">_termDefs</span></a></span><span> </span><span class="annot"><span class="annottext">DefState k uni fun a
</span><a href="#local-6989586621681110524"><span class="hs-identifier hs-var">defs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>                    </span><span id="local-6989586621681110517"><span class="annot"><span class="annottext">types :: Map k (Binding TyName Name uni fun a, Set k)
</span><a href="#local-6989586621681110517"><span class="hs-identifier hs-var hs-var">types</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b key. (a -&gt; b) -&gt; DefMap key a -&gt; DefMap key b
</span><a href="PlutusIR.Compiler.Definitions.html#mapDefs"><span class="hs-identifier hs-var">mapDefs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681110516"><span class="annot"><span class="annottext">Def (TyVarDecl TyName a) (Type TyName uni a)
</span><a href="#local-6989586621681110516"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; TyVarDecl tyname a
-&gt; Type tyname uni a
-&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-var">TypeBind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tyname ann. TyVarDecl tyname ann -&gt; ann
</span><a href="PlutusCore.Core.Type.html#_tyVarDeclAnn"><span class="hs-identifier hs-var">_tyVarDeclAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall var val. Def var val -&gt; var
</span><a href="PlutusCore.MkPlc.html#defVar"><span class="hs-identifier hs-var">defVar</span></a></span><span> </span><span class="annot"><span class="annottext">Def (TyVarDecl TyName a) (Type TyName uni a)
</span><a href="#local-6989586621681110516"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall var val. Def var val -&gt; var
</span><a href="PlutusCore.MkPlc.html#defVar"><span class="hs-identifier hs-var">PLC.defVar</span></a></span><span> </span><span class="annot"><span class="annottext">Def (TyVarDecl TyName a) (Type TyName uni a)
</span><a href="#local-6989586621681110516"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall var val. Def var val -&gt; val
</span><a href="PlutusCore.MkPlc.html#defVal"><span class="hs-identifier hs-var">PLC.defVal</span></a></span><span> </span><span class="annot"><span class="annottext">Def (TyVarDecl TyName a) (Type TyName uni a)
</span><a href="#local-6989586621681110516"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
DefState key uni fun ann -&gt; DefMap key (TypeDef TyName uni ann)
</span><a href="PlutusIR.Compiler.Definitions.html#_typeDefs"><span class="hs-identifier hs-var">_typeDefs</span></a></span><span> </span><span class="annot"><span class="annottext">DefState k uni fun a
</span><a href="#local-6989586621681110524"><span class="hs-identifier hs-var">defs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>                    </span><span id="local-6989586621681110513"><span class="annot"><span class="annottext">datatypes :: Map k (Binding TyName Name uni fun a, Set k)
</span><a href="#local-6989586621681110513"><span class="hs-identifier hs-var hs-var">datatypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b key. (a -&gt; b) -&gt; DefMap key a -&gt; DefMap key b
</span><a href="PlutusIR.Compiler.Definitions.html#mapDefs"><span class="hs-identifier hs-var">mapDefs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681110512"><span class="annot"><span class="annottext">Def (TyVarDecl TyName a) (Datatype TyName Name uni a)
</span><a href="#local-6989586621681110512"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; Datatype tyname name uni a -&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-var">DatatypeBind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall tyname ann. TyVarDecl tyname ann -&gt; ann
</span><a href="PlutusCore.Core.Type.html#_tyVarDeclAnn"><span class="hs-identifier hs-var">_tyVarDeclAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall var val. Def var val -&gt; var
</span><a href="PlutusCore.MkPlc.html#defVar"><span class="hs-identifier hs-var">defVar</span></a></span><span> </span><span class="annot"><span class="annottext">Def (TyVarDecl TyName a) (Datatype TyName Name uni a)
</span><a href="#local-6989586621681110512"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall var val. Def var val -&gt; val
</span><a href="PlutusCore.MkPlc.html#defVal"><span class="hs-identifier hs-var">PLC.defVal</span></a></span><span> </span><span class="annot"><span class="annottext">Def (TyVarDecl TyName a) (Datatype TyName Name uni a)
</span><a href="#local-6989586621681110512"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
DefState key uni fun ann
-&gt; DefMap key (DatatypeDef TyName Name uni ann)
</span><a href="PlutusIR.Compiler.Definitions.html#_datatypeDefs"><span class="hs-identifier hs-var">_datatypeDefs</span></a></span><span> </span><span class="annot"><span class="annottext">DefState k uni fun a
</span><a href="#local-6989586621681110524"><span class="hs-identifier hs-var">defs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Map k (Binding TyName Name uni fun a, Set k)
</span><a href="#local-6989586621681110523"><span class="hs-identifier hs-var">terms</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-operator hs-var">`Map.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map k (Binding TyName Name uni fun a, Set k)
</span><a href="#local-6989586621681110517"><span class="hs-identifier hs-var">types</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-operator hs-var">`Map.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map k (Binding TyName Name uni fun a, Set k)
</span><a href="#local-6989586621681110513"><span class="hs-identifier hs-var">datatypes</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Given the definitions in the program, create a topologically ordered list of the</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- SCCs using the dependency information</span><span>
</span><span id="line-110"></span><span id="local-6989586621681111097"><span id="local-6989586621681111098"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#defSccs"><span class="hs-identifier hs-type">defSccs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111098"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefMap"><span class="hs-identifier hs-type">DefMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111098"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111097"><span class="hs-identifier hs-type">def</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="../../../../algebraic-graphs/html/src"><span class="hs-identifier hs-type">NAM.AdjacencyMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111098"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-special">]</span></span></span><span>
</span><span id="line-111"></span><span id="defSccs"><span class="annot"><span class="annottext">defSccs :: forall key def. Ord key =&gt; DefMap key def -&gt; [AdjacencyMap key]
</span><a href="PlutusIR.Compiler.Definitions.html#defSccs"><span class="hs-identifier hs-var hs-var">defSccs</span></a></span></span><span> </span><span id="local-6989586621681110499"><span class="annot"><span class="annottext">DefMap key def
</span><a href="#local-6989586621681110499"><span class="hs-identifier hs-var">tds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-113"></span><span>        </span><span id="local-6989586621681110498"><span class="annot"><span class="annottext">perKeyDeps :: [(key, Set key)]
</span><a href="#local-6989586621681110498"><span class="hs-identifier hs-var hs-var">perKeyDeps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681110497"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110497"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">def
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681110496"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621681110496"><span class="hs-identifier hs-var">deps</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110497"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621681110496"><span class="hs-identifier hs-var">deps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.assocs</span></a></span><span> </span><span class="annot"><span class="annottext">DefMap key def
</span><a href="#local-6989586621681110499"><span class="hs-identifier hs-var">tds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>        </span><span id="local-6989586621681110494"><span class="annot"><span class="annottext">keySccs :: AdjacencyMap (AdjacencyMap key)
</span><a href="#local-6989586621681110494"><span class="hs-identifier hs-var hs-var">keySccs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; AdjacencyMap a -&gt; AdjacencyMap (AdjacencyMap a)
</span><a href="../../../../algebraic-graphs/html/src"><span class="hs-identifier hs-var">AM.scc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [(a, Set a)] -&gt; AdjacencyMap a
</span><a href="../../../../algebraic-graphs/html/src"><span class="hs-identifier hs-var">AM.fromAdjacencySets</span></a></span><span> </span><span class="annot"><span class="annottext">[(key, Set key)]
</span><a href="#local-6989586621681110498"><span class="hs-identifier hs-var">perKeyDeps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-comment">-- the graph made by 'scc' is guaranteed to be acyclic</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; AdjacencyMap a -&gt; Either (Cycle a) [a]
</span><a href="../../../../algebraic-graphs/html/src"><span class="hs-identifier hs-var">AM.topSort</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap (AdjacencyMap key)
</span><a href="#local-6989586621681110494"><span class="hs-identifier hs-var">keySccs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-117"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621681110490"><span class="annot"><span class="annottext">[AdjacencyMap key]
</span><a href="#local-6989586621681110490"><span class="hs-identifier hs-var">sorted</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[AdjacencyMap key]
</span><a href="#local-6989586621681110490"><span class="hs-identifier hs-var">sorted</span></a></span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-comment">-- TODO: report cycle</span><span>
</span><span id="line-119"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="annot"><span class="annottext">Cycle (AdjacencyMap key)
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;No topological sort of SCC graph&quot;</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span id="local-6989586621681111131"><span id="local-6989586621681111132"><span id="local-6989586621681111133"><span id="local-6989586621681111134"><span id="local-6989586621681111135"><span id="local-6989586621681111136"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#wrapWithDefs"><span class="hs-identifier hs-type">wrapWithDefs</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111136"><span class="hs-identifier hs-type">key</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681111135"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefMap"><span class="hs-identifier hs-type">DefMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111136"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111134"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111133"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111132"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111131"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111135"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111134"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111133"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111132"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111131"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111135"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111134"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111133"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111132"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111131"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111135"><span class="hs-identifier hs-type">ann</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-127"></span><span id="wrapWithDefs"><span class="annot"><span class="annottext">wrapWithDefs :: forall key ann tyname name (uni :: * -&gt; *) fun.
Ord key =&gt;
ann
-&gt; DefMap key (Binding tyname name uni fun ann)
-&gt; Term tyname name uni fun ann
-&gt; Term tyname name uni fun ann
</span><a href="PlutusIR.Compiler.Definitions.html#wrapWithDefs"><span class="hs-identifier hs-var hs-var">wrapWithDefs</span></a></span></span><span> </span><span id="local-6989586621681110475"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110475"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681110474"><span class="annot"><span class="annottext">DefMap key (Binding tyname name uni fun ann)
</span><a href="#local-6989586621681110474"><span class="hs-identifier hs-var">tds</span></a></span></span><span> </span><span id="local-6989586621681110473"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681110473"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681110472"><span class="annot"><span class="annottext">toValue :: key -&gt; Maybe (Binding tyname name uni fun ann)
</span><a href="#local-6989586621681110472"><span class="hs-identifier hs-var hs-var">toValue</span></a></span></span><span> </span><span id="local-6989586621681110471"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110471"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110471"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">DefMap key (Binding tyname name uni fun ann)
</span><a href="#local-6989586621681110474"><span class="hs-identifier hs-var">tds</span></a></span><span>
</span><span id="line-129"></span><span>        </span><span id="local-6989586621681110468"><span class="annot"><span class="annottext">wrapDefScc :: Term tyname name uni fun ann
-&gt; AdjacencyMap key -&gt; Term tyname name uni fun ann
</span><a href="#local-6989586621681110468"><span class="hs-identifier hs-var hs-var">wrapDefScc</span></a></span></span><span> </span><span id="local-6989586621681110467"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681110467"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621681110466"><span class="annot"><span class="annottext">AdjacencyMap key
</span><a href="#local-6989586621681110466"><span class="hs-identifier hs-var">scc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-130"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681110465"><span class="annot"><span class="annottext">bs :: [Binding tyname name uni fun ann]
</span><a href="#local-6989586621681110465"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [Maybe a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">catMaybes</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">key -&gt; Maybe (Binding tyname name uni fun ann)
</span><a href="#local-6989586621681110472"><span class="hs-identifier hs-var">toValue</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. (ToGraph t, Ord (ToVertex t)) =&gt; t -&gt; [ToVertex t]
</span><a href="../../../../algebraic-graphs/html/src"><span class="hs-identifier hs-var">Graph.vertexList</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap key
</span><a href="#local-6989586621681110466"><span class="hs-identifier hs-var">scc</span></a></span><span>
</span><span id="line-131"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a tyname name (uni :: * -&gt; *) fun.
a
-&gt; Recursivity
-&gt; [Binding tyname name uni fun a]
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.MkPir.html#mkLet"><span class="hs-identifier hs-var">mkLet</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110475"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall t. (ToGraph t, Ord (ToVertex t)) =&gt; t -&gt; Bool
</span><a href="../../../../algebraic-graphs/html/src"><span class="hs-identifier hs-var">Graph.isAcyclic</span></a></span><span> </span><span class="annot"><span class="annottext">AdjacencyMap key
</span><a href="#local-6989586621681110466"><span class="hs-identifier hs-var">scc</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="PlutusIR.Core.Type.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="PlutusIR.Core.Type.html#Rec"><span class="hs-identifier hs-var">Rec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Binding tyname name uni fun ann]
</span><a href="#local-6989586621681110465"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681110467"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-comment">-- process from the inside out</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
-&gt; AdjacencyMap key -&gt; Term tyname name uni fun ann
</span><a href="#local-6989586621681110468"><span class="hs-identifier hs-var">wrapDefScc</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681110473"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall key def. Ord key =&gt; DefMap key def -&gt; [AdjacencyMap key]
</span><a href="PlutusIR.Compiler.Definitions.html#defSccs"><span class="hs-identifier hs-var">defSccs</span></a></span><span> </span><span class="annot"><span class="annottext">DefMap key (Binding tyname name uni fun ann)
</span><a href="#local-6989586621681110474"><span class="hs-identifier hs-var">tds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111053"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111057"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadDefs"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-var">MonadDefs</span></a></span></span><span> </span><span id="local-6989586621681111057"><span class="annot"><a href="#local-6989586621681111057"><span class="hs-identifier hs-type">key</span></a></span></span><span> </span><span id="local-6989586621681111056"><span class="annot"><a href="#local-6989586621681111056"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621681111055"><span class="annot"><a href="#local-6989586621681111055"><span class="hs-identifier hs-type">fun</span></a></span></span><span> </span><span id="local-6989586621681111054"><span class="annot"><a href="#local-6989586621681111054"><span class="hs-identifier hs-type">ann</span></a></span></span><span> </span><span id="local-6989586621681111053"><span class="annot"><a href="#local-6989586621681111053"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621681111053"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681111057"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111056"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111055"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111054"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-136"></span><span>    </span><span id="liftDef"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#liftDef"><span class="hs-identifier hs-type">liftDef</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681111045"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-type">DefT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111057"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111056"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111055"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111054"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Identity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111045"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681111053"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111045"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-keyword">default</span><span> </span><span id="liftDef"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#liftDef"><span class="hs-identifier hs-type">liftDef</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681111049"><span id="local-6989586621681111051"><span id="local-6989586621681111052"><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111057"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111056"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111055"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111054"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111052"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">MonadTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111051"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681111051"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111052"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111053"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-type">DefT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111057"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111056"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111055"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111054"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Identity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111049"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681111053"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111049"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-138"></span><span>    </span><span id="local-6989586621681110455"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#liftDef"><span class="hs-identifier hs-var hs-var">liftDef</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
MonadDefs key uni fun ann m =&gt;
DefT key uni fun ann Identity a -&gt; m a
</span><a href="PlutusIR.Compiler.Definitions.html#liftDef"><span class="hs-identifier hs-var">liftDef</span></a></span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681111035"><span id="local-6989586621681111036"><span id="local-6989586621681111037"><span id="local-6989586621681111038"><span id="local-6989586621681111039"><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111039"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111038"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111039"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111037"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111036"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111035"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-type">DefT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111039"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111037"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111036"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111035"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111038"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621681110432"><span class="annot"><span class="annottext">liftDef :: forall a.
DefT key uni fun ann Identity a -&gt; DefT key uni fun ann m a
</span><a href="#local-6989586621681110432"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: (* -&gt; *) -&gt; k -&gt; *) (m :: * -&gt; *) (n :: * -&gt; *)
       (b :: k).
(MFunctor t, Monad m) =&gt;
(forall a. m a -&gt; n a) -&gt; t m b -&gt; t n b
</span><a href="../../../../mmorph/html/src"><span class="hs-identifier hs-var">MM.hoist</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Identity a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">runIdentity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681110423"><span id="local-6989586621681111027"><span id="local-6989586621681111028"><span id="local-6989586621681111029"><span id="local-6989586621681111030"><span id="local-6989586621681111031"><span id="local-6989586621681111032"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111032"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111031"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111030"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111029"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111028"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111032"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111031"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111030"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111029"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111027"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111028"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-144"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681110416"><span id="local-6989586621681111019"><span id="local-6989586621681111020"><span id="local-6989586621681111021"><span id="local-6989586621681111022"><span id="local-6989586621681111023"><span id="local-6989586621681111024"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111024"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111023"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111022"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111021"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111020"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111024"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111023"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111022"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111021"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111019"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111020"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-145"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681110409"><span id="local-6989586621681111011"><span id="local-6989586621681111012"><span id="local-6989586621681111013"><span id="local-6989586621681111014"><span id="local-6989586621681111015"><span id="local-6989586621681111016"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111016"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111015"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111014"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111013"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111012"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111016"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111015"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111014"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111013"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">ReaderT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111011"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111012"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span id="local-6989586621681111006"><span id="local-6989586621681111007"><span id="local-6989586621681111008"><span id="local-6989586621681111009"><span id="local-6989586621681111010"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#defineTerm"><span class="hs-identifier hs-type">defineTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111010"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111009"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111008"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111007"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111006"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681111010"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#TermDefWithStrictness"><span class="hs-identifier hs-type">TermDefWithStrictness</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111009"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111008"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111007"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681111010"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681111006"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-148"></span><span id="defineTerm"><span class="annot"><span class="annottext">defineTerm :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
key -&gt; TermDefWithStrictness uni fun ann -&gt; Set key -&gt; m ()
</span><a href="PlutusIR.Compiler.Definitions.html#defineTerm"><span class="hs-identifier hs-var hs-var">defineTerm</span></a></span></span><span> </span><span id="local-6989586621681110399"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110399"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681110398"><span class="annot"><span class="annottext">TermDefWithStrictness uni fun ann
</span><a href="#local-6989586621681110398"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621681110397"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621681110397"><span class="hs-identifier hs-var">deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
MonadDefs key uni fun ann m =&gt;
DefT key uni fun ann Identity a -&gt; m a
</span><a href="PlutusIR.Compiler.Definitions.html#liftDef"><span class="hs-identifier hs-var">liftDef</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
StateT (DefState key uni fun ann) m a -&gt; DefT key uni fun ann m a
</span><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-var">DefT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann fun.
Lens
  (DefState key uni fun ann)
  (DefState key uni fun ann)
  (DefMap key (TermDefWithStrictness uni fun ann))
  (DefMap key (TermDefWithStrictness uni fun ann))
</span><a href="PlutusIR.Compiler.Definitions.html#termDefs"><span class="hs-identifier hs-var">termDefs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110399"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TermDefWithStrictness uni fun ann
</span><a href="#local-6989586621681110398"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621681110397"><span class="hs-identifier hs-var">deps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span id="local-6989586621681110985"><span id="local-6989586621681110986"><span id="local-6989586621681110987"><span id="local-6989586621681110988"><span id="local-6989586621681110989"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#modifyTermDef"><span class="hs-identifier hs-type">modifyTermDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110989"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110988"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110987"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110986"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110985"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110989"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#TermDefWithStrictness"><span class="hs-identifier hs-type">TermDefWithStrictness</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110988"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110987"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110986"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#TermDefWithStrictness"><span class="hs-identifier hs-type">TermDefWithStrictness</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110988"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110987"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110986"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110985"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-151"></span><span id="modifyTermDef"><span class="annot"><span class="annottext">modifyTermDef :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
key
-&gt; (TermDefWithStrictness uni fun ann
    -&gt; TermDefWithStrictness uni fun ann)
-&gt; m ()
</span><a href="PlutusIR.Compiler.Definitions.html#modifyTermDef"><span class="hs-identifier hs-var hs-var">modifyTermDef</span></a></span></span><span> </span><span id="local-6989586621681110385"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110385"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681110384"><span class="annot"><span class="annottext">TermDefWithStrictness uni fun ann
-&gt; TermDefWithStrictness uni fun ann
</span><a href="#local-6989586621681110384"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
MonadDefs key uni fun ann m =&gt;
DefT key uni fun ann Identity a -&gt; m a
</span><a href="PlutusIR.Compiler.Definitions.html#liftDef"><span class="hs-identifier hs-var">liftDef</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
StateT (DefState key uni fun ann) m a -&gt; DefT key uni fun ann m a
</span><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-var">DefT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann fun.
Lens
  (DefState key uni fun ann)
  (DefState key uni fun ann)
  (DefMap key (TermDefWithStrictness uni fun ann))
  (DefMap key (TermDefWithStrictness uni fun ann))
</span><a href="PlutusIR.Compiler.Definitions.html#termDefs"><span class="hs-identifier hs-var">termDefs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">TermDefWithStrictness uni fun ann
-&gt; TermDefWithStrictness uni fun ann
</span><a href="#local-6989586621681110384"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110385"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span id="local-6989586621681110973"><span id="local-6989586621681110974"><span id="local-6989586621681110975"><span id="local-6989586621681110976"><span id="local-6989586621681110977"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#defineType"><span class="hs-identifier hs-type">defineType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110977"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110976"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110975"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110974"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110973"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110977"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.MkPlc.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110976"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110974"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110977"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110973"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-154"></span><span id="defineType"><span class="annot"><span class="annottext">defineType :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
key -&gt; TypeDef TyName uni ann -&gt; Set key -&gt; m ()
</span><a href="PlutusIR.Compiler.Definitions.html#defineType"><span class="hs-identifier hs-var hs-var">defineType</span></a></span></span><span> </span><span id="local-6989586621681110375"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110375"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681110374"><span class="annot"><span class="annottext">TypeDef TyName uni ann
</span><a href="#local-6989586621681110374"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621681110373"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621681110373"><span class="hs-identifier hs-var">deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
MonadDefs key uni fun ann m =&gt;
DefT key uni fun ann Identity a -&gt; m a
</span><a href="PlutusIR.Compiler.Definitions.html#liftDef"><span class="hs-identifier hs-var">liftDef</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
StateT (DefState key uni fun ann) m a -&gt; DefT key uni fun ann m a
</span><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-var">DefT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
Lens'
  (DefState key uni fun ann) (DefMap key (TypeDef TyName uni ann))
</span><a href="PlutusIR.Compiler.Definitions.html#typeDefs"><span class="hs-identifier hs-var">typeDefs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110375"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeDef TyName uni ann
</span><a href="#local-6989586621681110374"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621681110373"><span class="hs-identifier hs-var">deps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span id="local-6989586621681110963"><span id="local-6989586621681110964"><span id="local-6989586621681110965"><span id="local-6989586621681110966"><span id="local-6989586621681110967"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#modifyTypeDef"><span class="hs-identifier hs-type">modifyTypeDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110967"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110966"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110965"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110964"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110963"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110967"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.MkPlc.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110966"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110964"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.MkPlc.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110966"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110964"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110963"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-157"></span><span id="modifyTypeDef"><span class="annot"><span class="annottext">modifyTypeDef :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
key -&gt; (TypeDef TyName uni ann -&gt; TypeDef TyName uni ann) -&gt; m ()
</span><a href="PlutusIR.Compiler.Definitions.html#modifyTypeDef"><span class="hs-identifier hs-var hs-var">modifyTypeDef</span></a></span></span><span> </span><span id="local-6989586621681110364"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110364"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681110363"><span class="annot"><span class="annottext">TypeDef TyName uni ann -&gt; TypeDef TyName uni ann
</span><a href="#local-6989586621681110363"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
MonadDefs key uni fun ann m =&gt;
DefT key uni fun ann Identity a -&gt; m a
</span><a href="PlutusIR.Compiler.Definitions.html#liftDef"><span class="hs-identifier hs-var">liftDef</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
StateT (DefState key uni fun ann) m a -&gt; DefT key uni fun ann m a
</span><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-var">DefT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
Lens'
  (DefState key uni fun ann) (DefMap key (TypeDef TyName uni ann))
</span><a href="PlutusIR.Compiler.Definitions.html#typeDefs"><span class="hs-identifier hs-var">typeDefs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">TypeDef TyName uni ann -&gt; TypeDef TyName uni ann
</span><a href="#local-6989586621681110363"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110364"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#defineDatatype"><span class="hs-identifier hs-type">defineDatatype</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681110957"><span class="annot"><a href="#local-6989586621681110957"><span class="hs-identifier hs-type">key</span></a></span></span><span> </span><span id="local-6989586621681110956"><span class="annot"><a href="#local-6989586621681110956"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621681110955"><span class="annot"><a href="#local-6989586621681110955"><span class="hs-identifier hs-type">fun</span></a></span></span><span> </span><span id="local-6989586621681110954"><span class="annot"><a href="#local-6989586621681110954"><span class="hs-identifier hs-type">ann</span></a></span></span><span> </span><span id="local-6989586621681110953"><span class="annot"><a href="#local-6989586621681110953"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110957"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110956"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110955"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110954"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110953"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110957"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusIR.MkPir.html#DatatypeDef"><span class="hs-identifier hs-type">DatatypeDef</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110956"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110954"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110957"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110953"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span id="defineDatatype"><span class="annot"><span class="annottext">defineDatatype :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
key -&gt; DatatypeDef TyName Name uni ann -&gt; Set key -&gt; m ()
</span><a href="PlutusIR.Compiler.Definitions.html#defineDatatype"><span class="hs-identifier hs-var hs-var">defineDatatype</span></a></span></span><span> </span><span id="local-6989586621681110355"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110355"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681110354"><span class="annot"><span class="annottext">DatatypeDef TyName Name uni ann
</span><a href="#local-6989586621681110354"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621681110353"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621681110353"><span class="hs-identifier hs-var">deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
MonadDefs key uni fun ann m =&gt;
DefT key uni fun ann Identity a -&gt; m a
</span><a href="PlutusIR.Compiler.Definitions.html#liftDef"><span class="hs-identifier hs-var">liftDef</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
StateT (DefState key uni fun ann) m a -&gt; DefT key uni fun ann m a
</span><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-var">DefT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
Lens'
  (DefState key uni fun ann)
  (DefMap key (DatatypeDef TyName Name uni ann))
</span><a href="PlutusIR.Compiler.Definitions.html#datatypeDefs"><span class="hs-identifier hs-var">datatypeDefs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110355"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatatypeDef TyName Name uni ann
</span><a href="#local-6989586621681110354"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621681110353"><span class="hs-identifier hs-var">deps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span id="local-6989586621681110943"><span id="local-6989586621681110944"><span id="local-6989586621681110945"><span id="local-6989586621681110946"><span id="local-6989586621681110947"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#modifyDatatypeDef"><span class="hs-identifier hs-type">modifyDatatypeDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110947"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110946"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110945"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110944"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110943"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110947"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.MkPir.html#DatatypeDef"><span class="hs-identifier hs-type">DatatypeDef</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110946"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110944"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusIR.MkPir.html#DatatypeDef"><span class="hs-identifier hs-type">DatatypeDef</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110946"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110944"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110943"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-165"></span><span id="modifyDatatypeDef"><span class="annot"><span class="annottext">modifyDatatypeDef :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
key
-&gt; (DatatypeDef TyName Name uni ann
    -&gt; DatatypeDef TyName Name uni ann)
-&gt; m ()
</span><a href="PlutusIR.Compiler.Definitions.html#modifyDatatypeDef"><span class="hs-identifier hs-var hs-var">modifyDatatypeDef</span></a></span></span><span> </span><span id="local-6989586621681110344"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110344"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681110343"><span class="annot"><span class="annottext">DatatypeDef TyName Name uni ann -&gt; DatatypeDef TyName Name uni ann
</span><a href="#local-6989586621681110343"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
MonadDefs key uni fun ann m =&gt;
DefT key uni fun ann Identity a -&gt; m a
</span><a href="PlutusIR.Compiler.Definitions.html#liftDef"><span class="hs-identifier hs-var">liftDef</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
StateT (DefState key uni fun ann) m a -&gt; DefT key uni fun ann m a
</span><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-var">DefT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
Lens'
  (DefState key uni fun ann)
  (DefMap key (DatatypeDef TyName Name uni ann))
</span><a href="PlutusIR.Compiler.Definitions.html#datatypeDefs"><span class="hs-identifier hs-var">datatypeDefs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">DatatypeDef TyName Name uni ann -&gt; DatatypeDef TyName Name uni ann
</span><a href="#local-6989586621681110343"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110344"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- | Modifies the dependency set of a key.</span><span>
</span><span id="line-168"></span><span id="local-6989586621681110933"><span id="local-6989586621681110934"><span id="local-6989586621681110935"><span id="local-6989586621681110936"><span id="local-6989586621681110937"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#modifyDeps"><span class="hs-identifier hs-type">modifyDeps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110937"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110936"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110935"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110934"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110933"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110937"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110937"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110937"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110933"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-169"></span><span id="modifyDeps"><span class="annot"><span class="annottext">modifyDeps :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
key -&gt; (Set key -&gt; Set key) -&gt; m ()
</span><a href="PlutusIR.Compiler.Definitions.html#modifyDeps"><span class="hs-identifier hs-var hs-var">modifyDeps</span></a></span></span><span> </span><span id="local-6989586621681110324"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110324"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681110323"><span class="annot"><span class="annottext">Set key -&gt; Set key
</span><a href="#local-6989586621681110323"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
MonadDefs key uni fun ann m =&gt;
DefT key uni fun ann Identity a -&gt; m a
</span><a href="PlutusIR.Compiler.Definitions.html#liftDef"><span class="hs-identifier hs-var">liftDef</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
StateT (DefState key uni fun ann) m a -&gt; DefT key uni fun ann m a
</span><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-var">DefT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-comment">-- This is a little crude: we expect most keys will appear in only one map, so we just modify the</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-comment">-- dependencies in all of them! That lets us just have one function.</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann fun.
Lens
  (DefState key uni fun ann)
  (DefState key uni fun ann)
  (DefMap key (TermDefWithStrictness uni fun ann))
  (DefMap key (TermDefWithStrictness uni fun ann))
</span><a href="PlutusIR.Compiler.Definitions.html#termDefs"><span class="hs-identifier hs-var">termDefs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">Set key -&gt; Set key
</span><a href="#local-6989586621681110323"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110324"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
Lens'
  (DefState key uni fun ann) (DefMap key (TypeDef TyName uni ann))
</span><a href="PlutusIR.Compiler.Definitions.html#typeDefs"><span class="hs-identifier hs-var">typeDefs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">Set key -&gt; Set key
</span><a href="#local-6989586621681110323"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110324"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
Lens'
  (DefState key uni fun ann)
  (DefMap key (DatatypeDef TyName Name uni ann))
</span><a href="PlutusIR.Compiler.Definitions.html#datatypeDefs"><span class="hs-identifier hs-var">datatypeDefs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">Set key -&gt; Set key
</span><a href="#local-6989586621681110323"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110324"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#recordAlias"><span class="hs-identifier hs-type">recordAlias</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681110924"><span class="annot"><a href="#local-6989586621681110924"><span class="hs-identifier hs-type">key</span></a></span></span><span> </span><span id="local-6989586621681110923"><span class="annot"><a href="#local-6989586621681110923"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621681110922"><span class="annot"><a href="#local-6989586621681110922"><span class="hs-identifier hs-type">fun</span></a></span></span><span> </span><span id="local-6989586621681110921"><span class="annot"><a href="#local-6989586621681110921"><span class="hs-identifier hs-type">ann</span></a></span></span><span> </span><span id="local-6989586621681110920"><span class="annot"><a href="#local-6989586621681110920"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110924"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110923"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110922"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110921"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110920"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110924"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110920"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span id="recordAlias"><span class="annot"><span class="annottext">recordAlias :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
key -&gt; m ()
</span><a href="PlutusIR.Compiler.Definitions.html#recordAlias"><span class="hs-identifier hs-var hs-var">recordAlias</span></a></span></span><span> </span><span id="local-6989586621681110315"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110315"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
MonadDefs key uni fun ann m =&gt;
DefT key uni fun ann Identity a -&gt; m a
</span><a href="PlutusIR.Compiler.Definitions.html#liftDef"><span class="hs-identifier hs-var">liftDef</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681110924"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681110923"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681110922"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681110921"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
StateT (DefState key uni fun ann) m a -&gt; DefT key uni fun ann m a
</span><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-var">DefT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
Lens' (DefState key uni fun ann) (Set key)
</span><a href="PlutusIR.Compiler.Definitions.html#aliases"><span class="hs-identifier hs-var">aliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110315"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span id="local-6989586621681110909"><span id="local-6989586621681110910"><span id="local-6989586621681110911"><span id="local-6989586621681110912"><span id="local-6989586621681110913"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#lookupTerm"><span class="hs-identifier hs-type">lookupTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110913"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110912"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110911"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110910"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110909"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110910"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110913"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110909"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110912"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110911"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110910"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-180"></span><span id="lookupTerm"><span class="annot"><span class="annottext">lookupTerm :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
ann -&gt; key -&gt; m (Maybe (Term TyName Name uni fun ann))
</span><a href="PlutusIR.Compiler.Definitions.html#lookupTerm"><span class="hs-identifier hs-var hs-var">lookupTerm</span></a></span></span><span> </span><span id="local-6989586621681110300"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110300"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681110299"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110299"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefState"><span class="hs-identifier hs-type">DefState</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">_termDefs :: forall key (uni :: * -&gt; *) fun ann.
DefState key uni fun ann
-&gt; DefMap key (TermDefWithStrictness uni fun ann)
</span><a href="PlutusIR.Compiler.Definitions.html#_termDefs"><span class="hs-identifier hs-var">_termDefs</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621681110298"><span class="annot"><span class="annottext">DefMap key (TermDefWithStrictness uni fun ann)
</span><a href="#local-6989586621681110298"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">_aliases :: forall key (uni :: * -&gt; *) fun ann.
DefState key uni fun ann -&gt; Set key
</span><a href="PlutusIR.Compiler.Definitions.html#_aliases"><span class="hs-identifier hs-var">_aliases</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621681110297"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621681110297"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
MonadDefs key uni fun ann m =&gt;
DefT key uni fun ann Identity a -&gt; m a
</span><a href="PlutusIR.Compiler.Definitions.html#liftDef"><span class="hs-identifier hs-var">liftDef</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
StateT (DefState key uni fun ann) m a -&gt; DefT key uni fun ann m a
</span><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-var">DefT</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110299"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">DefMap key (TermDefWithStrictness uni fun ann)
</span><a href="#local-6989586621681110298"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681110296"><span class="annot"><span class="annottext">TermDefWithStrictness uni fun ann
</span><a href="#local-6989586621681110296"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set key
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.member</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110299"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621681110297"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
ann -&gt; VarDecl tyname name uni ann -&gt; term ann
</span><a href="PlutusCore.MkPlc.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110300"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall var val. Def var val -&gt; var
</span><a href="PlutusCore.MkPlc.html#defVar"><span class="hs-identifier hs-var">PLC.defVar</span></a></span><span> </span><span class="annot"><span class="annottext">TermDefWithStrictness uni fun ann
</span><a href="#local-6989586621681110296"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><span class="annottext">Maybe (TermDefWithStrictness uni fun ann, Set key)
</span><span class="hs-identifier">_</span></span><span>                                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span id="local-6989586621681110886"><span id="local-6989586621681110887"><span id="local-6989586621681110888"><span id="local-6989586621681110889"><span id="local-6989586621681110890"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#lookupOrDefineTerm"><span class="hs-identifier hs-type">lookupOrDefineTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110890"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110889"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110888"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110887"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110886"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110887"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110890"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110886"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#TermDefWithStrictness"><span class="hs-identifier hs-type">TermDefWithStrictness</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110889"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110888"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110887"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110890"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110886"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110889"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110888"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110887"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-187"></span><span id="lookupOrDefineTerm"><span class="annot"><span class="annottext">lookupOrDefineTerm :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
ann
-&gt; key
-&gt; m (TermDefWithStrictness uni fun ann, Set key)
-&gt; m (Term TyName Name uni fun ann)
</span><a href="PlutusIR.Compiler.Definitions.html#lookupOrDefineTerm"><span class="hs-identifier hs-var hs-var">lookupOrDefineTerm</span></a></span></span><span> </span><span id="local-6989586621681110281"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110281"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681110280"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110280"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681110279"><span class="annot"><span class="annottext">m (TermDefWithStrictness uni fun ann, Set key)
</span><a href="#local-6989586621681110279"><span class="hs-identifier hs-var">mdef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621681110278"><span class="annot"><span class="annottext">Maybe (Term TyName Name uni fun ann)
</span><a href="#local-6989586621681110278"><span class="hs-identifier hs-var">mTerm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
ann -&gt; key -&gt; m (Maybe (Term TyName Name uni fun ann))
</span><a href="PlutusIR.Compiler.Definitions.html#lookupTerm"><span class="hs-identifier hs-var">lookupTerm</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110281"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110280"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Term TyName Name uni fun ann)
</span><a href="#local-6989586621681110278"><span class="hs-identifier hs-var">mTerm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681110277"><span class="annot"><span class="annottext">Term TyName Name uni fun ann
</span><a href="#local-6989586621681110277"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Term TyName Name uni fun ann
</span><a href="#local-6989586621681110277"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Term TyName Name uni fun ann)
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-192"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621681110276"><span class="annot"><span class="annottext">TermDefWithStrictness uni fun ann
</span><a href="#local-6989586621681110276"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681110275"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621681110275"><span class="hs-identifier hs-var">deps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (TermDefWithStrictness uni fun ann, Set key)
</span><a href="#local-6989586621681110279"><span class="hs-identifier hs-var">mdef</span></a></span><span>
</span><span id="line-193"></span><span>            </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
key -&gt; TermDefWithStrictness uni fun ann -&gt; Set key -&gt; m ()
</span><a href="PlutusIR.Compiler.Definitions.html#defineTerm"><span class="hs-identifier hs-var">defineTerm</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110280"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">TermDefWithStrictness uni fun ann
</span><a href="#local-6989586621681110276"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621681110275"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-194"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
ann -&gt; VarDecl tyname name uni ann -&gt; term ann
</span><a href="PlutusCore.MkPlc.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110281"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall var val. Def var val -&gt; var
</span><a href="PlutusCore.MkPlc.html#defVar"><span class="hs-identifier hs-var">PLC.defVar</span></a></span><span> </span><span class="annot"><span class="annottext">TermDefWithStrictness uni fun ann
</span><a href="#local-6989586621681110276"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span id="local-6989586621681110876"><span id="local-6989586621681110877"><span id="local-6989586621681110878"><span id="local-6989586621681110879"><span id="local-6989586621681110880"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#lookupType"><span class="hs-identifier hs-type">lookupType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110880"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110879"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110878"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110877"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110876"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110877"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110880"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110876"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110879"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110877"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-197"></span><span id="lookupType"><span class="annot"><span class="annottext">lookupType :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
ann -&gt; key -&gt; m (Maybe (Type TyName uni ann))
</span><a href="PlutusIR.Compiler.Definitions.html#lookupType"><span class="hs-identifier hs-var hs-var">lookupType</span></a></span></span><span> </span><span id="local-6989586621681110262"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110262"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681110261"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110261"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#DefState"><span class="hs-identifier hs-type">DefState</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">_typeDefs :: forall key (uni :: * -&gt; *) fun ann.
DefState key uni fun ann -&gt; DefMap key (TypeDef TyName uni ann)
</span><a href="PlutusIR.Compiler.Definitions.html#_typeDefs"><span class="hs-identifier hs-var">_typeDefs</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621681110260"><span class="annot"><span class="annottext">DefMap key (TypeDef TyName uni ann)
</span><a href="#local-6989586621681110260"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_datatypeDefs :: forall key (uni :: * -&gt; *) fun ann.
DefState key uni fun ann
-&gt; DefMap key (DatatypeDef TyName Name uni ann)
</span><a href="PlutusIR.Compiler.Definitions.html#_datatypeDefs"><span class="hs-identifier hs-var">_datatypeDefs</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621681110259"><span class="annot"><span class="annottext">DefMap key (DatatypeDef TyName Name uni ann)
</span><a href="#local-6989586621681110259"><span class="hs-identifier hs-var">dtys</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_aliases :: forall key (uni :: * -&gt; *) fun ann.
DefState key uni fun ann -&gt; Set key
</span><a href="PlutusIR.Compiler.Definitions.html#_aliases"><span class="hs-identifier hs-var">_aliases</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621681110258"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621681110258"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
MonadDefs key uni fun ann m =&gt;
DefT key uni fun ann Identity a -&gt; m a
</span><a href="PlutusIR.Compiler.Definitions.html#liftDef"><span class="hs-identifier hs-var">liftDef</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
StateT (DefState key uni fun ann) m a -&gt; DefT key uni fun ann m a
</span><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-var">DefT</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110261"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">DefMap key (TypeDef TyName uni ann)
</span><a href="#local-6989586621681110260"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681110257"><span class="annot"><span class="annottext">TypeDef TyName uni ann
</span><a href="#local-6989586621681110257"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set key
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.member</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110261"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621681110258"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall var val. Def var val -&gt; val
</span><a href="PlutusCore.MkPlc.html#defVal"><span class="hs-identifier hs-var">PLC.defVal</span></a></span><span> </span><span class="annot"><span class="annottext">TypeDef TyName uni ann
</span><a href="#local-6989586621681110257"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall ann tyname (uni :: * -&gt; *).
ann -&gt; TyVarDecl tyname ann -&gt; Type tyname uni ann
</span><a href="PlutusCore.MkPlc.html#mkTyVar"><span class="hs-identifier hs-var">mkTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110262"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall var val. Def var val -&gt; var
</span><a href="PlutusCore.MkPlc.html#defVar"><span class="hs-identifier hs-var">PLC.defVar</span></a></span><span> </span><span class="annot"><span class="annottext">TypeDef TyName uni ann
</span><a href="#local-6989586621681110257"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-201"></span><span>        </span><span class="annot"><span class="annottext">Maybe (TypeDef TyName uni ann, Set key)
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110261"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">DefMap key (DatatypeDef TyName Name uni ann)
</span><a href="#local-6989586621681110259"><span class="hs-identifier hs-var">dtys</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-202"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681110255"><span class="annot"><span class="annottext">DatatypeDef TyName Name uni ann
</span><a href="#local-6989586621681110255"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set key
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann tyname (uni :: * -&gt; *).
ann -&gt; TyVarDecl tyname ann -&gt; Type tyname uni ann
</span><a href="PlutusCore.MkPlc.html#mkTyVar"><span class="hs-identifier hs-var">mkTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110262"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall var val. Def var val -&gt; var
</span><a href="PlutusCore.MkPlc.html#defVar"><span class="hs-identifier hs-var">PLC.defVar</span></a></span><span> </span><span class="annot"><span class="annottext">DatatypeDef TyName Name uni ann
</span><a href="#local-6989586621681110255"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-203"></span><span>            </span><span class="annot"><span class="annottext">Maybe (DatatypeDef TyName Name uni ann, Set key)
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span id="local-6989586621681110863"><span id="local-6989586621681110864"><span id="local-6989586621681110865"><span id="local-6989586621681110866"><span id="local-6989586621681110867"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#lookupOrDefineType"><span class="hs-identifier hs-type">lookupOrDefineType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110867"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110866"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110865"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110864"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110863"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110864"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110867"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110863"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.MkPlc.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110866"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110864"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110867"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110863"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110866"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110864"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-206"></span><span id="lookupOrDefineType"><span class="annot"><span class="annottext">lookupOrDefineType :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
ann
-&gt; key
-&gt; m (TypeDef TyName uni ann, Set key)
-&gt; m (Type TyName uni ann)
</span><a href="PlutusIR.Compiler.Definitions.html#lookupOrDefineType"><span class="hs-identifier hs-var hs-var">lookupOrDefineType</span></a></span></span><span> </span><span id="local-6989586621681110244"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110244"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681110243"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110243"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681110242"><span class="annot"><span class="annottext">m (TypeDef TyName uni ann, Set key)
</span><a href="#local-6989586621681110242"><span class="hs-identifier hs-var">mdef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621681110241"><span class="annot"><span class="annottext">Maybe (Type TyName uni ann)
</span><a href="#local-6989586621681110241"><span class="hs-identifier hs-var">mTy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
ann -&gt; key -&gt; m (Maybe (Type TyName uni ann))
</span><a href="PlutusIR.Compiler.Definitions.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110244"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110243"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Type TyName uni ann)
</span><a href="#local-6989586621681110241"><span class="hs-identifier hs-var">mTy</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681110240"><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681110240"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Type TyName uni ann
</span><a href="#local-6989586621681110240"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-210"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Type TyName uni ann)
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-211"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621681110239"><span class="annot"><span class="annottext">TypeDef TyName uni ann
</span><a href="#local-6989586621681110239"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681110238"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621681110238"><span class="hs-identifier hs-var">deps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (TypeDef TyName uni ann, Set key)
</span><a href="#local-6989586621681110242"><span class="hs-identifier hs-var">mdef</span></a></span><span>
</span><span id="line-212"></span><span>            </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
key -&gt; TypeDef TyName uni ann -&gt; Set key -&gt; m ()
</span><a href="PlutusIR.Compiler.Definitions.html#defineType"><span class="hs-identifier hs-var">defineType</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110243"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">TypeDef TyName uni ann
</span><a href="#local-6989586621681110239"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621681110238"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-213"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann tyname (uni :: * -&gt; *).
ann -&gt; TyVarDecl tyname ann -&gt; Type tyname uni ann
</span><a href="PlutusCore.MkPlc.html#mkTyVar"><span class="hs-identifier hs-var">mkTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110244"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall var val. Def var val -&gt; var
</span><a href="PlutusCore.MkPlc.html#defVar"><span class="hs-identifier hs-var">PLC.defVar</span></a></span><span> </span><span class="annot"><span class="annottext">TypeDef TyName uni ann
</span><a href="#local-6989586621681110239"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span id="local-6989586621681110853"><span id="local-6989586621681110854"><span id="local-6989586621681110855"><span id="local-6989586621681110856"><span id="local-6989586621681110857"><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#lookupConstructors"><span class="hs-identifier hs-type">lookupConstructors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110857"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110856"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110855"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110854"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110853"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110854"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110857"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110853"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110856"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110855"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110854"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-216"></span><span id="lookupConstructors"><span class="annot"><span class="annottext">lookupConstructors :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
ann -&gt; key -&gt; m (Maybe [Term TyName Name uni fun ann])
</span><a href="PlutusIR.Compiler.Definitions.html#lookupConstructors"><span class="hs-identifier hs-var hs-var">lookupConstructors</span></a></span></span><span> </span><span id="local-6989586621681110223"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110223"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681110222"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110222"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-217"></span><span>    </span><span id="local-6989586621681110221"><span class="annot"><span class="annottext">DefMap key (DatatypeDef TyName Name uni ann)
</span><a href="#local-6989586621681110221"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
MonadDefs key uni fun ann m =&gt;
DefT key uni fun ann Identity a -&gt; m a
</span><a href="PlutusIR.Compiler.Definitions.html#liftDef"><span class="hs-identifier hs-var">liftDef</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
StateT (DefState key uni fun ann) m a -&gt; DefT key uni fun ann m a
</span><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-var">DefT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
Lens'
  (DefState key uni fun ann)
  (DefMap key (DatatypeDef TyName Name uni ann))
</span><a href="PlutusIR.Compiler.Definitions.html#datatypeDefs"><span class="hs-identifier hs-var">datatypeDefs</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110222"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">DefMap key (DatatypeDef TyName Name uni ann)
</span><a href="#local-6989586621681110221"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.MkPlc.html#Def"><span class="hs-identifier hs-type">PLC.Def</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">defVal :: forall var val. Def var val -&gt; val
</span><a href="PlutusCore.MkPlc.html#defVal"><span class="hs-identifier hs-var">PLC.defVal</span></a></span><span class="hs-glyph">=</span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TyVarDecl TyName ann
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl TyName ann]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681110217"><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681110217"><span class="hs-identifier hs-var">constrs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set key
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (term :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
TermLike term tyname name uni fun =&gt;
ann -&gt; VarDecl tyname name uni ann -&gt; term ann
</span><a href="PlutusCore.MkPlc.html#mkVar"><span class="hs-identifier hs-var">mkVar</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110223"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><a href="#local-6989586621681110217"><span class="hs-identifier hs-var">constrs</span></a></span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><span class="annottext">Maybe (DatatypeDef TyName Name uni ann, Set key)
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>                                                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#lookupDestructor"><span class="hs-identifier hs-type">lookupDestructor</span></a></span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681110216"><span class="annot"><a href="#local-6989586621681110216"><span class="hs-identifier hs-type">key</span></a></span></span><span> </span><span id="local-6989586621681110215"><span class="annot"><a href="#local-6989586621681110215"><span class="hs-identifier hs-type">uni</span></a></span></span><span> </span><span id="local-6989586621681110214"><span class="annot"><a href="#local-6989586621681110214"><span class="hs-identifier hs-type">fun</span></a></span></span><span> </span><span id="local-6989586621681110213"><span class="annot"><a href="#local-6989586621681110213"><span class="hs-identifier hs-type">ann</span></a></span></span><span> </span><span id="local-6989586621681110212"><span class="annot"><a href="#local-6989586621681110212"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Compiler.Definitions.html#MonadDefs"><span class="hs-identifier hs-type">MonadDefs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110216"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110215"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110214"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110213"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110212"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110213"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110216"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681110212"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#TyName"><span class="hs-identifier hs-type">TyName</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110215"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110214"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681110213"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span id="lookupDestructor"><span class="annot"><span class="annottext">lookupDestructor :: forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
MonadDefs key uni fun ann m =&gt;
ann -&gt; key -&gt; m (Maybe (Term TyName Name uni fun ann))
</span><a href="PlutusIR.Compiler.Definitions.html#lookupDestructor"><span class="hs-identifier hs-var hs-var">lookupDestructor</span></a></span></span><span> </span><span id="local-6989586621681110200"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110200"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681110199"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110199"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621681110198"><span class="annot"><span class="annottext">DefMap key (DatatypeDef TyName Name uni ann)
</span><a href="#local-6989586621681110198"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
MonadDefs key uni fun ann m =&gt;
DefT key uni fun ann Identity a -&gt; m a
</span><a href="PlutusIR.Compiler.Definitions.html#liftDef"><span class="hs-identifier hs-var">liftDef</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681110216"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681110215"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681110214"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621681110213"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann (m :: * -&gt; *) a.
StateT (DefState key uni fun ann) m a -&gt; DefT key uni fun ann m a
</span><a href="PlutusIR.Compiler.Definitions.html#DefT"><span class="hs-identifier hs-var">DefT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; Getting a s a -&gt; m a
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">use</span></a></span><span> </span><span class="annot"><span class="annottext">forall key (uni :: * -&gt; *) fun ann.
Lens'
  (DefState key uni fun ann)
  (DefMap key (DatatypeDef TyName Name uni ann))
</span><a href="PlutusIR.Compiler.Definitions.html#datatypeDefs"><span class="hs-identifier hs-var">datatypeDefs</span></a></span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621681110199"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">DefMap key (DatatypeDef TyName Name uni ann)
</span><a href="#local-6989586621681110198"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.MkPlc.html#Def"><span class="hs-identifier hs-type">PLC.Def</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">defVal :: forall var val. Def var val -&gt; val
</span><a href="PlutusCore.MkPlc.html#defVal"><span class="hs-identifier hs-var">PLC.defVal</span></a></span><span class="hs-glyph">=</span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TyVarDecl TyName ann
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl TyName ann]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681110197"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681110197"><span class="hs-identifier hs-var">destr</span></a></span></span><span> </span><span class="annot"><span class="annottext">[VarDecl TyName Name uni ann]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set key
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; name -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681110200"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681110197"><span class="hs-identifier hs-var">destr</span></a></span><span>
</span><span id="line-229"></span><span>        </span><span class="annot"><span class="annottext">Maybe (DatatypeDef TyName Name uni ann, Set key)
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>                                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-230"></span></pre></body></html>